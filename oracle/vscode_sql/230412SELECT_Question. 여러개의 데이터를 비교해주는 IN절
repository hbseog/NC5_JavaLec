-- 11. 여러개의 데이터를 비교해주는 IN절
-- 화학과나 물리학과 학생이면서 1,2,3학년인 학생만 조회
SELECT * FROM STUDENT
WHERE MAJOR IN ('화학','물리')
AND SYEAR IN (1,2,3);

-- 업무가 개발, 경영이면서 보너스가 700이상인 직원 목록 조회
SELECT * FROM EMP
WHERE JOB IN ('개발', '경영')
AND SAL >=700;

-- 과목의 PNO를 사용해서 PROFESSOR
SELECT A.*, B.PNAME
FROM COURSE A
    LEFT OUTER JOIN PROFESSOR B
        on A.PNO = B.PNO;

CREATE TABLE BOARD_A(
BOARD_NO NUMBER, BOARD_TITLE VARCHAR(50)
);

CREATE TABLE BOARD_B(
BOARD_NO NUMBER, FILE_NM VARCHAR(50)
);

INSERT INTO BOARD_A VALUES (4,'AA');

SELECT * FROM BOARD_A;

SELECT B.*,A.BOARD_TITLE
FROM BOARD_B B
LEFT OUTER JOIN BOARD_A A
on B.BOARD_NO = A.BOARD_NO;

-- INNER JOUN
-- SCORE테이블의 모든 데이터와 STUDENT데이블 학생이름 조회
SELECT SC.*, ST.SNAME
FROM SCORE SC
INNER JOIN STUDENT ST
ON SC.SNO = ST.SNO

-- 모든 사원정보와 부서명을 한 번에 조회
-- ANSI 표준
SELECT EM.*, DE.DNAME
FROM EMP EM INNER JOIN DEPT DE
ON EM.DNO = DE.DNO

-- 다른 형태의 JOIN
SELECT EM.*, DE.DNAME
FROM EMP EM, DEPT DE
WHERE EM.DNO = DE.DNO

-- 비등가 JOIN
SELECT SC.*, GR.GRADE
FROM SCORE SC
INNER JOIN SCGRADE GR
ON SC.RESULT BETWEEN GR.LOSCORE AND GR.HISCORE

-- 사원의 모든 정보와 해당 사원에 대한 급여등급 정보 조회(>,<,<=,>=,BETWEEN ...)
SELECT EM.*, GR.GRADE
FROM EMP EM
INNER JOIN SALGRADE GR
ON EM.SAL BETWEEN GR.LOSAL AND GR.HISAL

-- CROSSJOIN: 조인 조건을 명시하지 않으면 의미없는 데이터가 조회된다.
SELECT
    A.ENO,
    A.ENAME,
    A.DNO,
    B.DNAME
FROM
    EMP A,
    DEPT B;

-- 셀프조인
-- FROM절의 테이블과 조인되는 테이블이 같을 때
-- 사원의 사수의 이름을 조회
SELECT A.ENO, A.ENAME, A.MGR, B.ENAME, B.ENO
FROM EMP A
JOIN EMP B
ON A.MGR = B.ENO

-- 3. OUTER JOIN
-- 사원의 사수의 이름을 조회하는데 사수가 존재하지 않는 사원들도 모두 조회
SELECT A.ENO, A.ENAME, A.MGR, B.ENAME, B.ENO
FROM EMP A
LEFT JOIN EMP B
ON A.MGR = B.ENO

-- 과목들의 정보를 조회, 교수의 이름과 같이 조회(담당교수가 없는 과목도 조회)
SELECT A.*,B.PNAME
FROM COURSE A
LEFT JOIN PROFESSOR B
ON A.PNO = B.PNO;

SELECT A.*,B.PNAME
FROM COURSE A,PROFESSOR B
WHERE A.PNO = B.PNO(+);

-- 다중 조인
-- 사원의 모든 정보 조회, 급여등급과 부서명이 같이 조회되도록
SELECT E.ENO, E.ENAME, E.MGR, E.SAL, S.GRADE, E.DNO, D.DNAME,
       M.ENAME
FROM EMP E
JOIN SALGRADE S
ON E.SAL BETWEEN S.LOSAL AND S.HISAL
JOIN DEPT D
ON E.DNO = D.DNO
LEFT JOIN EMP M
ON E.MGR = M.ENO;

-- 기말고사 성적을 조회-> 과목이름, 담당교수 이름까지 조회(과목번호 순서 정렬)
SELECT S.SNO AS 학번,
       T.SNAME AS 이름,
       C.CNAME AS 과목,
       P.PNAME AS 교수,
       S.RESULT AS 점수,
       G.GRADE AS 등급
FROM SCORE S
JOIN COURSE C
ON S.CNO = C.CNO
JOIN PROFESSOR P
ON P.PNO = C.PNO
JOIN STUDENT T
ON T.SNO = S.SNO
JOIN SCGRADE G
ON S.RESULT BETWEEN G.LOSCORE AND G.HISCORE
ORDER BY S.RESULT DESC ;


----------------------------------------


--1) 평점이 3.0에서 4.0사이의 학생을 검색하라(between and)
SELECT S.*
FROM STUDENT S
WHERE S.AVR BETWEEN 3.0 AND 4.0;

--2) 1994년에서 1995년까지 부임한 교수의 명단을 검색하라(between and)
SELECT P.*
FROM PROFESSOR P
WHERE P.HIREDATE BETWEEN TO_DATE('19940101 00:00:00','YYYYMMDD HH24:mi:ss')
    AND TO_DATE('19951231 12:59:59','YYYYMMDD HH24:mi:ss');

--3) 화학과와 물리학과, 생물학과 학생을 검색하라(in)
SELECT S.*
FROM STUDENT S
WHERE S.MAJOR IN ('화학','물리','생물');

--4) 정교수와 조교수를 검색하라(in)
SELECT P.*
FROM PROFESSOR P
WHERE P.ORDERS IN ('정교수','조교수');

--5) 학점수가 1학점, 2학점인 과목을 검색하라(in)
SELECT C.*
FROM COURSE C
WHERE C.ST_NUM IN (1,2);

--6) 1, 2학년 학생 중에 평점이 2.0에서 3.0사이인 학생을 검색하라(between and)
SELECT S.*
FROM STUDENT S
WHERE S.SYEAR IN (1,2) AND S.AVR BETWEEN 2.0 AND 3.0;

--7) 화학, 물리학과 학생 중 1, 2 학년 학생을 성적순으로 검색하라(in)
SELECT S.*
FROM STUDENT S
WHERE S.MAJOR IN ('화학','물리') AND S.SYEAR IN (1,2) ORDER BY S.AVR DESC ;

--8) 부임일이 1995년 이전인 정교수를 검색하라(to_date)
SELECT P.*
FROM PROFESSOR P
WHERE P.HIREDATE < TO_DATE('19950101','YYYYMMDD') AND P.ORDERS = '정교수';



--1) 송강 교수가 강의하는 과목을 검색한다
SELECT C.CNAME, P.PNAME
FROM COURSE C
JOIN PROFESSOR P
ON C.PNO = P.PNO AND P.PNAME = '송강';

--2) 화학 관련 과목을 강의하는 교수의 명단을 검색한다
SELECT P.*, C.CNAME
FROM PROFESSOR P
JOIN COURSE C
ON P.PNO = C.PNO AND C.CNAME LIKE ('%화학%');

--3) 학점이 2학점인 과목과 이를 강의하는 교수를 검색한다
SELECT P.*,C.ST_NUM
FROM PROFESSOR P
JOIN COURSE C
ON C.ST_NUM = 2 AND C.PNO = P.PNO;

--4) 화학과 교수가 강의하는 과목을 검색한다
SELECT C.*, P.SECTION
FROM COURSE C
JOIN PROFESSOR P
ON P.SECTION = '화학' AND C.PNO = P.PNO;

--5) 화학과 1학년 학생의 기말고사 성적을 검색한다
SELECT SC.RESULT, ST.SYEAR
FROM SCORE SC
JOIN STUDENT ST
ON ST.SYEAR = 1 AND ST.MAJOR = '화학' AND ST.SNO = SC.SNO;

--6) 일반화학 과목의 기말고사 점수를 검색한다
SELECT S.RESULT, C.CNAME
FROM SCORE S
JOIN COURSE C
ON C.CNAME = '일반화학' AND C.CNO = S.CNO;

--7) 화학과 1학년 학생의 일반화학 기말고사 점수를 검색한다
SELECT SC.RESULT, ST.MAJOR, ST.SYEAR, C.CNO, ST.SNAME, C.CNAME
FROM SCORE SC
JOIN STUDENT ST
ON ST.SNO = SC.SNO
JOIN COURSE C
ON C.CNO = SC.CNO
AND ST.SYEAR = 1
AND ST.MAJOR = '화학'
AND C.CNAME = '일반화학';


--8) 화학과 1학년 학생이 수강하는 과목을 검색한다
SELECT DISTINCT C.CNO, C.CNAME, ST.SYEAR, ST.MAJOR
FROM SCORE SC
JOIN STUDENT ST
ON SC.SNO = ST.SNO
JOIN COURSE C
ON C.CNO = SC.CNO AND ST.SYEAR = 1 AND ST.MAJOR = '화학';


--9) 유기화학 과목의 평가점수가 F인 학생의 명단을 검색한다
SELECT DISTINCT ST.SNAME, SCG.GRADE, SC.RESULT
FROM SCORE SC
JOIN STUDENT ST
ON SC.SNO = ST.SNO
JOIN COURSE C
ON C.CNO = SC.CNO AND C.CNAME = '유기화학'
JOIN SCGRADE SCG
ON SCG.GRADE = 'F' AND SC.RESULT BETWEEN SCG.LOSCORE AND SCG.HISCORE





--1) 학생중에 동명이인을 검색한다
SELECT DISTINCT S.*
FROM STUDENT S
JOIN STUDENT ST
ON S.SNAME = ST.SNAME AND S.SNO != ST.SNO
ORDER BY S.SNO;

--2) 전체 교수 명단과 교수가 담당하는 과목의 이름을 학과 순으로 검색한다


--3) 이번 학기 등록된 모든 과목과 담당 교수의 학점 순으로 검색한다





--1) 각 과목의 과목명과 담당 교수의 교수명을 검색하라


--2) 화학과 학생의 기말고사 성적을 모두 검색하라


--3) 유기화학과목 수강생의 기말고사 시험점수를 검색하라


--4) 화학과 학생이 수강하는 과목을 담당하는 교수의 명단을 검색하라


--5) 모든 교수의 명단과 담당 과목을 검색한다


--6) 모든 교수의 명단과 담당 과목을 검색한다(단 모든 과목도 같이 검색한다)